# Development Environment

This development setup provides hot reload functionality for debugging Svelte components using your existing Rollup configuration.

## Quick Start

### Option 1: Automatic (Recommended)
```bash
# Terminal 1: Start the development server and Rollup watcher
npm run dev:watch &
npm run dev:start

# Open http://localhost:3000 in your browser
```

### Option 2: Manual Control
```bash
# Terminal 1: Start Rollup in watch mode
npm run dev:watch

# Terminal 2: Start the development server
npm run dev:server

# Open http://localhost:3000 in your browser
```

## Features

- ✅ **Hot Reload**: Changes auto-refresh the browser
- ✅ **Source Maps**: Debug original Svelte code in browser dev tools
- ✅ **Same Build Pipeline**: Uses Rollup (same as production)
- ✅ **Component Testing**: Test individual components with sample data
- ✅ **Real-time Console**: See console output in the browser
- ✅ **Error Handling**: Clear error messages when components fail

## How It Works

1. **Rollup Watch**: Monitors your Svelte components and rebuilds `dev/bundle.js` on changes
2. **Development Server**: Serves the HTML and JavaScript files
3. **WebSocket Connection**: Notifies browser when bundle.js changes
4. **Auto Reload**: Browser refreshes automatically on file changes

## Testing Components

The development interface provides buttons to test each component:

- **Chart Manager**: Tests the main chart management component
- **Importance Chart**: Tests the original importance chart
- **Importance Chart 2**: Tests the enhanced importance chart
- **Simple Display**: Tests basic Svelte functionality
- **Scatter SHAP Values**: Tests SHAP value scatter plot
- **Clear**: Unmounts the current component

## Debugging Workflow

1. Edit any Svelte component in `src/xaiflow/templates/components/`
2. Rollup automatically rebuilds the bundle
3. Browser automatically refreshes with your changes
4. Use browser dev tools to:
   - Set breakpoints in original Svelte code (thanks to source maps)
   - Inspect component state and props
   - View console output and errors
   - Test different data scenarios

## File Structure

```
dev/
├── dev-entry.js          # Entry point that imports all components
├── dev-index.html        # Development HTML with test interface
├── dev-server.js         # Hot reload server
├── rollup.config.dev.js  # Rollup config for development
├── bundle.js             # Generated by Rollup (auto-created)
└── bundle.js.map         # Source maps (auto-created)
```

## Troubleshooting

**Bundle not updating?**
- Check that `npm run dev:watch` is running
- Look for Rollup errors in the terminal
- Refresh the browser manually

**Components not loading?**
- Check browser console for JavaScript errors
- Verify component imports in `dev-entry.js`
- Check if Chart.js loaded (should see ✅ in console)

**Hot reload not working?**
- Check WebSocket connection in browser dev tools (Network tab)
- Restart the development server
- Clear browser cache

## Production Build

When ready to test in MLflow:
```bash
npm run build
```

This creates the production bundle using your original `rollup.config.js`.
